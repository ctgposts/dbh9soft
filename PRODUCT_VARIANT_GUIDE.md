# ржкржгрзНржп ржУ ржнрзЗрж░рж┐ржпрж╝рзЗржирзНржЯ ржорзНржпрж╛ржирзЗржЬржорзЗржирзНржЯ ржЧрж╛ржЗржб
## Product & Variant Management Guide

### тЬЕ рж╕рж┐рж╕рзНржЯрзЗржо ржлрж┐ржХрзНрж╕ - System Fixes Applied

#### 1. **ржирждрзБржи productVariants ржЯрзЗржмрж┐рж▓ ржпрзЛржЧ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗ**
   - Database-ржП ржкржгрзНржпрзЗрж░ ржкрзНрж░рждрж┐ржЯрж┐ ржнрзЗрж░рж┐ржпрж╝рзЗржирзНржЯ (рж░ржЩ + рж╕рж╛ржЗржЬ рж╕ржВржорж┐рж╢рзНрж░ржг) рж╕ржВрж░ржХрзНрж╖ржг ржХрж░рждрзЗ ржкрж╛рж░рзЗ

#### 2. **ржирждрзБржи Backend API Functions**
   - `api.products.createWithVariants` - ржорж╛рж▓рзНржЯрж┐ржкрж▓ ржнрзЗрж░рж┐ржпрж╝рзЗржирзНржЯ рж╕рж╣ ржкржгрзНржп рждрзИрж░рж┐
   - `api.products.searchWithVariants` - ржнрзЗрж░рж┐ржпрж╝рзЗржирзНржЯ ржЗржиржлрж░ржорзЗрж╢ржи рж╕рж╣ ржЕржирзБрж╕ржирзНржзрж╛ржи
   - `api.variants.*` - рж╕ржм ржнрзЗрж░рж┐ржпрж╝рзЗржирзНржЯ ржорзНржпрж╛ржирзЗржЬржорзЗржирзНржЯ ржлрж╛ржВрж╢ржи

#### 3. **ржбрзЗржЯрж╛ рж╕рзНржЯрзНрж░рж╛ржХржЪрж╛рж░**
   ```
   products (ржорзВрж▓ ржкржгрзНржп)
     тФЬтФАтФА name, brand, fabric
     тФЬтФАтФА costPrice, sellingPrice
     тФФтФАтФА currentStock (рж╕ржм ржнрзЗрж░рж┐ржпрж╝рзЗржирзНржЯрзЗрж░ рж╕ржорж╖рзНржЯрж┐)
   
   productVariants (ржкрзНрж░рждрж┐ржЯрж┐ рж░ржЩ + рж╕рж╛ржЗржЬ рж╕ржВржорж┐рж╢рзНрж░ржг)
     тФЬтФАтФА productId (ржорзВрж▓ ржкржгрзНржпрзЗрж░ reference)
     тФЬтФАтФА color, sizes[]
     тФЬтФАтФА stock { currentStock, minStockLevel, maxStockLevel }
     тФЬтФАтФА variantBarcode (рж╕рзНржХрзНржпрж╛ржиржпрзЛржЧрзНржп)
     тФФтФАтФА price (ржЕржкрж╢ржирж╛рж▓ - ржкржгрзНржпрзЗрж░ price-ржПрж░ ржЪрзЗржпрж╝рзЗ ржнрж┐ржирзНржи рж╣рждрзЗ ржкрж╛рж░рзЗ)
   ```

---

## ЁЯУЭ ржкржгрзНржп рждрзИрж░рж┐рж░ ржЙржкрж╛ржпрж╝ - How to Create Products

### **ржкржжрзНржзрждрж┐ рзз: рж╕рж╛ржзрж╛рж░ржг ржкржгрзНржп (ржПржХржЯрж┐ рж░ржЩ)**
```typescript
const productId = await addProduct({
  name: "Dubai Abaya Red",
  brand: "Dubai Borka House",
  fabric: "Crepe",
  color: "Red",
  sizes: ["50", "52", "54"],
  costPrice: 400,
  sellingPrice: 1200,
  currentStock: 10,
  minStockLevel: 5,
  maxStockLevel: 100,
  isActive: true,
});
```

### **ржкржжрзНржзрждрж┐ рзи: ржорж╛рж▓рзНржЯрж┐-ржнрзЗрж░рж┐ржпрж╝рзЗржирзНржЯ ржкржгрзНржп (ржПржХрж╛ржзрж┐ржХ рж░ржЩ)**
```typescript
const result = await createWithVariants({
  name: "Dubai Abaya Premium",
  brand: "Dubai Borka House",
  fabric: "Crepe",
  embellishments: "Embroidered",
  costPrice: 500,
  sellingPrice: 1500,
  minStockLevel: 5,
  maxStockLevel: 100,
  variants: [
    {
      color: "Black",
      sizes: ["50", "52", "54"],
      stock: 15,
      barcode: "DBH-BLACK-001",
      price: 1500, // ржЕржкрж╢ржирж╛рж▓
    },
    {
      color: "Maroon",
      sizes: ["50", "52", "54"],
      stock: 12,
      barcode: "DBH-MAROON-001",
      price: 1600,
    },
    {
      color: "Navy",
      sizes: ["50", "52", "54"],
      stock: 10,
      barcode: "DBH-NAVY-001",
    },
  ],
});

// рж░рзЗржЬрж╛рж▓рзНржЯ: 
// {
//   productId: "...",
//   variantCount: 3,
//   totalStock: 37,
// }
```

---

## ЁЯФН ржкржгрзНржп ржЕржирзБрж╕ржирзНржзрж╛ржи - How to Search Products

### **ржнрзЗрж░рж┐ржпрж╝рзЗржирзНржЯ ржЗржиржлрж░ржорзЗрж╢ржи рж╕рж╣ ржЕржирзБрж╕ржирзНржзрж╛ржи**
```typescript
const results = await searchWithVariants("Dubai");
// рж░рзЗржЬрж╛рж▓рзНржЯ:
// [
//   {
//     product: { _id, name, brand, ... },
//     variants: [
//       { color: "Black", stock: { currentStock: 15 }, ... },
//       { color: "Maroon", stock: { currentStock: 12 }, ... },
//     ]
//   }
// ]
```

---

## ЁЯУж ржнрзЗрж░рж┐ржпрж╝рзЗржирзНржЯ ржорзНржпрж╛ржирзЗржЬржорзЗржирзНржЯ - Variant Management

### **ржПржХржЯрж┐ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржкржгрзНржпрзЗрж░ рж╕ржм ржнрзЗрж░рж┐ржпрж╝рзЗржирзНржЯ ржкрзЗрждрзЗ**
```typescript
const variants = await getProductVariants(productId);
// рж░рзЗржЬрж╛рж▓рзНржЯ: Array of active variants with colors and stock info
```

### **ржмрж╛рж░ржХрзЛржб ржжрзНржмрж╛рж░рж╛ ржнрзЗрж░рж┐ржпрж╝рзЗржирзНржЯ ржЦрзБржБржЬрждрзЗ**
```typescript
const variant = await getVariantByBarcode("DBH-BLACK-001");
// рж░рзЗржЬрж╛рж▓рзНржЯ: 
// {
//   _id: "...",
//   color: "Black",
//   sizes: ["50", "52", "54"],
//   stock: { currentStock: 15, minStockLevel: 5, ... },
//   price: 1500,
// }
```

### **ржнрзЗрж░рж┐ржпрж╝рзЗржирзНржЯ рж╕рзНржЯржХ рж╕ржоржирзНржмржпрж╝ ржХрж░рждрзЗ**
```typescript
const newStock = await adjustVariantStock(
  variantId,
  -3, // ржХржорж╛ржирзЛ (ржирзЗржЧрзЗржЯрж┐ржн) ржмрж╛ ржмрж╛ржбрж╝рж╛ржирзЛ (ржкржЬрж┐ржЯрж┐ржн)
  "Sale" // reason
);
```

### **ржнрзЗрж░рж┐ржпрж╝рзЗржирзНржЯ ржЖржкржбрзЗржЯ ржХрж░рждрзЗ**
```typescript
await updateVariant(variantId, {
  color: "Black", // ржЕржкрж╢ржирж╛рж▓
  sizes: ["50", "52", "54", "56"], // ржЕржкрж╢ржирж╛рж▓
  currentStock: 20, // ржЕржкрж╢ржирж╛рж▓
  price: 1600, // ржЕржкрж╢ржирж╛рж▓
});
```

---

## ЁЯзк ржЯрзЗрж╕рзНржЯрж┐ржВ - Testing

### **Step 1: ржПржХржЯрж┐ ржорж╛рж▓рзНржЯрж┐-ржнрзЗрж░рж┐ржпрж╝рзЗржирзНржЯ ржкржгрзНржп рждрзИрж░рж┐ ржХрж░рзБржи**
1. Inventory-ржП ржпрж╛ржи
2. "Add Product" ржХрзНрж▓рж┐ржХ ржХрж░рзБржи
3. ржкржгрзНржпрзЗрж░ ржирж╛ржо, ржмрзНрж░рзНржпрж╛ржирзНржб, ржлрзНржпрж╛ржмрзНрж░рж┐ржХ ржжрж┐ржи
4. ржПржХрж╛ржзрж┐ржХ рж░ржЩ/рж╕рж╛ржЗржЬ ржпрзЛржЧ ржХрж░рзБржи:
   - Black 50, 52, 54 - Stock: 15
   - Red 50, 52, 54 - Stock: 10
   - Navy 50, 52, 54 - Stock: 12
5. Save ржХрж░рзБржи

### **Step 2: ржкржгрзНржпржЯрж┐ ржЕржирзБрж╕ржирзНржзрж╛ржи ржХрж░рзБржи**
1. Search-ржП ржкржгрзНржпрзЗрж░ ржирж╛ржо ржЯрж╛ржЗржк ржХрж░рзБржи
2. рж╕ржм ржнрзЗрж░рж┐ржпрж╝рзЗржирзНржЯ ржбрж┐рж╕ржкрзНрж▓рзЗ рж╣ржУржпрж╝рж╛ ржЙржЪрж┐ржд

### **Step 3: POS-ржП ржпрж╛ржи**
1. ржкржгрзНржпржЯрж┐ ржпрзЛржЧ ржХрж░рзБржи
2. рж░ржЩ ржПржмржВ рж╕рж╛ржЗржЬ ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рзБржи
3. рж╕ржарж┐ржХ рж╕рзНржЯржХ ржжрзЗржЦрж╛ржирзЛ ржЙржЪрж┐ржд

### **Step 4: Scanner ржжрж┐ржпрж╝рзЗ ржкрж░рзАржХрзНрж╖рж╛ ржХрж░рзБржи**
1. Staff Portal > Scanner ржпрж╛ржи
2. ржнрзЗрж░рж┐ржпрж╝рзЗржирзНржЯрзЗрж░ ржмрж╛рж░ржХрзЛржб рж╕рзНржХрзНржпрж╛ржи ржХрж░рзБржи
3. рж╕ржарж┐ржХ ржнрзЗрж░рж┐ржпрж╝рзЗржирзНржЯ ржПржмржВ рж╕рзНржЯржХ ржжрзЗржЦрж╛ржирзЛ ржЙржЪрж┐ржд

---

## ЁЯУК ржбрзЗржЯрж╛ ржорж╛ржЗржЧрзНрж░рзЗрж╢ржи - Data Migration

ржпржжрж┐ ржЖржкржирж╛рж░ ржХрж╛ржЫрзЗ ржкрзБрж░рж╛ржирзЛ ржбрзЗржЯрж╛ ржерж╛ржХрзЗ рждржмрзЗ:

### **ржкрзБрж░рж╛ржирзЛ ржкржгрзНржп ржерзЗржХрзЗ ржнрзЗрж░рж┐ржпрж╝рзЗржирзНржЯрзЗ ржХржиржнрж╛рж░рзНржЯ ржХрж░рждрзЗ**
```typescript
// ржПржЗ ржлрж╛ржВрж╢ржи ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржЖржкржирж╛рж░ ржкрзБрж░рж╛ржирзЛ ржкржгрзНржп ржбрзЗржЯрж╛ ржорж╛ржЗржЧрзНрж░рзЗржЯ ржХрж░рзБржи
// ржПржХржЗ ржирж╛ржо/ржмрзНрж░рзНржпрж╛ржирзНржб ржХрж┐ржирзНрждрзБ ржнрж┐ржирзНржи рж░ржЩрзЗрж░ ржкржгрзНржпржЧрзБрж▓рзЛ ржПржХржЯрж┐рждрзЗ ржорж╛рж░рзНржЬ ржХрж░ржмрзЗ

// Contact: Support for migration assistance
```

---

## тЪая╕П рж╕рж╛ржзрж╛рж░ржг рж╕ржорж╕рзНржпрж╛ - Common Issues

### **рж╕ржорж╕рзНржпрж╛ 1: "ржнрзЗрж░рж┐ржпрж╝рзЗржирзНржЯ ржжрзЗржЦрж╛ ржпрж╛ржЪрзНржЫрзЗ ржирж╛"**
- **ржХрж╛рж░ржг**: ржнрзЗрж░рж┐ржпрж╝рзЗржирзНржЯржЧрзБрж▓рж┐ `isActive: false`
- **рж╕ржорж╛ржзрж╛ржи**: `updateVariant` ржжрж┐ржпрж╝рзЗ `isActive: true` ржХрж░рзБржи

### **рж╕ржорж╕рзНржпрж╛ 2: "рж╕рзНржЯржХ рж╕ржарж┐ржХ ржиржпрж╝"**
- **ржХрж╛рж░ржг**: ржорзВрж▓ ржкржгрзНржпрзЗрж░ `currentStock` ржУ ржнрзЗрж░рж┐ржпрж╝рзЗржирзНржЯрзЗрж░ рж╕рзНржЯржХ рж╕рж┐ржЩрзНржХ ржирзЗржЗ
- **рж╕ржорж╛ржзрж╛ржи**: 
  ```typescript
  // ржкржгрзНржпрзЗрж░ рж╕рзНржЯржХ ржЖржкржбрзЗржЯ ржХрж░рзБржи = рж╕ржм ржнрзЗрж░рж┐ржпрж╝рзЗржирзНржЯрзЗрж░ ржпрзЛржЧ
  const allVariants = await getProductVariants(productId);
  const totalStock = allVariants.reduce((sum, v) => sum + v.stock.currentStock, 0);
  await updateProduct({ id: productId, currentStock: totalStock });
  ```

### **рж╕ржорж╕рзНржпрж╛ 3: "ржмрж╛рж░ржХрзЛржб ржиржХрж▓"**
- **ржХрж╛рж░ржг**: ржжрзБржЯрж┐ ржнрзЗрж░рж┐ржпрж╝рзЗржирзНржЯрзЗрж░ ржПржХржЗ ржмрж╛рж░ржХрзЛржб
- **рж╕ржорж╛ржзрж╛ржи**: ржкрзНрж░рждрж┐ржЯрж┐ ржнрзЗрж░рж┐ржпрж╝рзЗржирзНржЯрзЗ ржЗржЙржирж┐ржХ ржмрж╛рж░ржХрзЛржб ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржи

---

## ЁЯФР ржирж┐рж░рж╛ржкрждрзНрждрж╛ - Security

тЬЕ **рж╕ржм ржЕржкрж╛рж░рзЗрж╢ржи рж╕рзБрж░ржХрзНрж╖рж┐ржд**:
- ржЗржЙржЬрж╛рж░ ржЕржерзЗржирзНржЯрж┐ржХрзЗрж╢ржи ржЪрзЗржХ ржХрж░рж╛ рж╣ржпрж╝
- ржЗржиржнрзНржпрж╛рж▓рж┐ржб рж╕рзНржЯржХ ржирзЗржЧрзЗржЯрж┐ржн рж╣рждрзЗ ржкрж╛рж░рзЗ ржирж╛
- ржбрзБржкрзНрж▓рж┐ржХрзЗржЯ ржмрж╛рж░ржХрзЛржб ржкрзНрж░рждрж┐рж░рзЛржз ржХрж░рж╛ рж╣ржпрж╝

---

## ЁЯУЮ рж╕рж╛ржкрзЛрж░рзНржЯ - Support

ржпржжрж┐ рж╕ржорж╕рзНржпрж╛ рж╣ржпрж╝:
1. Browser Console (F12) ржЪрзЗржХ ржХрж░рзБржи
2. Convex Dashboard Log ржжрзЗржЦрзБржи
3. рждрж╛рж░ржкрж░ Support-ржП ржпрзЛржЧрж╛ржпрзЛржЧ ржХрж░рзБржи

---

**ржЖржкржбрзЗржЯ**: February 5, 2026
**рж╕рзНржЯрзНржпрж╛ржЯрж╛рж╕**: тЬЕ рж╕ржорзНржкрзВрж░рзНржг ржПржмржВ ржкрзНрж░рж╕рзНрждрзБржд
